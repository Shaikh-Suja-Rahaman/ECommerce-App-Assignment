# Minimal E-Commerce API (Spring Boot + MongoDB + Razorpay)

## Prerequisites
- Java 21
- Maven 3.9+
- MongoDB running locally (e.g., Compass) at `mongodb://localhost:27017/ecommerce`
- Razorpay test/live credentials (`razorpay.keyId`, `razorpay.keySecret`, `razorpay.webhookSecret`)

## Run
```bash
./mvnw spring-boot:run
```

## Configure
Edit `src/main/resources/application.properties`:
```
spring.data.mongodb.uri=mongodb://localhost:27017/ecommerce
razorpay.keyId=YOUR_KEY_ID
razorpay.keySecret=YOUR_KEY_SECRET
razorpay.webhookSecret=YOUR_WEBHOOK_SECRET
```

## Endpoints (happy-path)
- `POST /api/products` – create product
- `GET /api/products` – list products
- `POST /api/cart/add` – add to cart
- `GET /api/cart/{userId}` – view cart
- `DELETE /api/cart/{userId}/clear` – clear cart
- `POST /api/orders` – create order from cart
- `GET /api/orders/{orderId}` – get order
- `GET /api/orders/user/{userId}` – list user orders
- `POST /api/payments/create` – create Razorpay order for payment
- `POST /api/webhooks/payment` – Razorpay webhook callback (set header `X-Razorpay-Signature`)

## Payment Flow
1) Create products → add to cart → create order (status `CREATED`).
2) Call `/api/payments/create` with `{ "orderId": "..." }` to get `providerOrderId` (Razorpay order id).
3) Complete payment via Razorpay Checkout using that order id.
4) Razorpay sends webhook to `/api/webhooks/payment`; order is marked `PAID` or `FAILED`.

## Notes
- IDs are UUID strings generated by MongoDB.
- Amounts use `BigDecimal` in INR; Razorpay expects paise so conversion is handled in service.
- Webhook signature verification uses `razorpay.webhookSecret` (required in production).
- No auth is added; suitable for classroom/demo use only.
